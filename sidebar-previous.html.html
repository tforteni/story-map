<!DOCTYPE html>
<html>
  <body style="font-family:Arial,sans-serif; margin:10px;">
    <div id="map-container">‚è≥ Loading last map...</div>

    <script>
      google.script.run
        .withSuccessHandler(result => {
          const container = document.getElementById('map-container');
          if (result.error) {
            container.innerText = result.error;
            return;
          }

          container.innerHTML = `
            <img src="${result.dataUrl}" width="100%" alt="Story Map">
            <p style="font-size:12px; color:gray;">
              File: <b>${result.fileName}</b><br>
              Updated: ${new Date(result.lastUpdated).toLocaleString()}<br>
              <a href="${result.folderUrl}" target="_blank">Open Story Maps Folder</a>
            </p>
          `;
        })
        .withFailureHandler(err => {
          document.getElementById('map-container').innerText =
            'Error loading map: ' + err.message;
        })
        .loadLastMap();
    </script>
  </body>
</html>
